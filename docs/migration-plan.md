# 점진 마이그레이션 계획 (Bridge → Full TS)

> 상태 업데이트: **2단계(완전 전환) 진행중**

## 목표

기존 기능 회귀 없이 게임을 점진적으로 TypeScript/React 중심 구조로 이전하고,
팀 단위로 병렬 작업 가능한 기준(역할 분리 + 인터페이스 고정 + 완료 조건)을 확보한다.

## 1단계: 브리지(Bridge)

> **목표**: 기존 게임 로직은 유지하되, React UI 래핑과 핵심 타입 도입으로 전환 기반을 만든다.

### 범위

- React UI를 게임 엔진 호스트로 사용하고 입력/상태 표시를 컴포넌트로 통합
- 기존 게임 루프 동작은 유지
- 핵심 타입(방향, 색상, 맵/타일 표현 등) 도입

### 산출물

- `GameEngine` 중심의 엔진 호출 계층 확립
- `src/types/game.ts` 기반 공용 타입 사용
- UI 컴포넌트(`GameUI`, `DirectionPad`, `ColorButtons`, `Toast`)와 엔진 간 이벤트 연동

### 수용 기준

- 기존 조작(W/A/S/D, 색상 변경, R 재시작) 동작 동일
- CLEAR 토스트, 가시성 업데이트, 전방 하이라이트 정상 동작
- 핵심 경로에서 `any` 남용 없음

## 2단계: 완전 전환(Full TS)

> **목표**: 엔진 모듈을 전면 TypeScript화하고 DOM 직접 접근을 제거하여 UI/엔진 인터페이스를 고정한다.

### 범위

- 게임 관련 모듈을 TS 기준으로 일원화
- DOM 직접 접근/전역 의존 제거 (입력, 상태 표시, 토스트 등)
- 엔진과 UI 사이의 인터페이스 계약 명시

### 산출물

- 엔진 공개 API 확정(초기화/업데이트/입력/해제)
- UI는 인터페이스를 통해서만 엔진 제어
- 핵심 모듈 strict 타입 검증 통과

### 수용 기준

- [ ] `tsconfig.json`에 `strict: true` 적용
- [ ] strict 타입 체크 통과(핵심 엔진 모듈 포함)
- [x] UI 계층이 엔진 내부 구현 세부사항에 의존하지 않음
- [x] 기존 기능 회귀 없음(조작/클리어 연출/가시성/하이라이트 동일)
- [x] `src` 디렉터리 `.js/.jsx` 제거 및 `.ts/.tsx` 일원화

## 완료 기준 (Definition of Done)

아래 항목을 모두 만족하면 마이그레이션 단계 완료로 간주한다.

1. **기능 동등성**
   - 기존 조작(WASD/색상/재시작)이 동일하게 동작
2. **핵심 UX 보장**
   - CLEAR 토스트 표시
   - 가시성(opacity) 업데이트
   - 전방 하이라이트 갱신
3. **타입 안전성**
   - `tsconfig.json`에 `strict: true` 적용
   - strict 타입 체크 통과(핵심 엔진 모듈 포함)
   - `any` 남용 금지
4. **팀 작업 가능성**
   - 엔진-UI 인터페이스가 문서화되어 병렬 작업 가능
   - 단계별 산출물/검증 기준이 README 및 문서에 명시

## 상태 체크리스트

### 완료(Complete)

- [x] 기능 동등성 확보
- [x] 핵심 UX(토스트/가시성/하이라이트) 유지
- [x] UI ↔ 엔진 인터페이스 문서화
- [x] 단계별 기준을 README/문서에 반영
- [ ] `strict: true` 적용 및 strict 타입 체크 통과

### 진행중(In Progress)

- [ ] `strict: true` 적용 전 타입 오류 목록 정리
- [ ] strict 전환 시 필요한 리팩터링 범위 확정
